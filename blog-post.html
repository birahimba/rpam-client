<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title id="article-title">Article - Blog RPAM</title>
    <meta name="description" id="article-description"
        content="Blog RPAM - Orientation professionnelle, coaching et développement de compétences">

    <meta property="og:title" id="og-title" content="Article - Blog RPAM">
    <meta property="og:description" id="og-description" content="Blog RPAM">
    <meta property="og:type" content="article">
    <meta property="og:image" id="og-image" content="">

    <link rel="icon" type="image/png" href="images/favicon-32x32.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/vendors.min.css">
    <link rel="stylesheet" href="css/icon.min.css">
    <link rel="stylesheet" href="css/style.min.css">
    <link rel="stylesheet" href="css/responsive.min.css">
    <link rel="stylesheet" href="css/corporate.css">
    <link rel="canonical" id="canonical-url" href="">

    <!-- DOMPurify pour la sanitisation XSS -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>

    <style>
        .article-container {
            padding: 40px 20px;
        }

        .sidebar-widget {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }

        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--base-color, #0d6efd);
        }

        .related-article-item {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
            transition: transform 0.2s ease;
        }

        .related-article-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .related-article-item:hover {
            transform: translateX(5px);
        }

        .related-article-thumb {
            width: 80px;
            height: 80px;
            border-radius: 6px;
            object-fit: cover;
            flex-shrink: 0;
        }

        .related-article-content h4 {
            font-size: 0.95rem;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 5px;
            line-height: 1.4;
        }

        .related-article-content h4 a {
            color: #1a1a1a;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .related-article-content h4 a:hover {
            color: var(--base-color, #0d6efd);
        }

        .related-article-meta {
            font-size: 0.8rem;
            color: #999;
        }

        .tags-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .tag-item {
            display: inline-block;
            padding: 8px 16px;
            background: #f0f0f0;
            color: #333;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .tag-item:hover {
            background: var(--base-color, #0d6efd);
            color: white;
            transform: translateY(-2px);
        }

        @media (max-width: 992px) {
            .sidebar-sticky {
                position: relative !important;
                top: 0 !important;
                margin-top: 40px;
            }
        }

        .article-header {
            margin-bottom: 40px;
        }

        .article-cover {
            width: 100%;
            max-height: 500px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .article-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            color: #666;
            font-size: 0.95rem;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .article-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .article-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1a1a1a;
            line-height: 1.2;
            margin-bottom: 20px;
        }

        .article-subtitle {
            font-size: 1.2rem;
            color: #666;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .article-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
        }

        .article-tag {
            background-color: #f0f0f0;
            color: #333;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .article-tag:hover {
            background-color: var(--base-color, #0d6efd);
            color: white;
        }

        .article-content {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #333;
        }

        .article-content h1,
        .article-content h2,
        .article-content h3,
        .article-content h4,
        .article-content h5,
        .article-content h6 {
            font-weight: 600;
            margin-top: 40px;
            margin-bottom: 20px;
            color: #1a1a1a;
            line-height: 1.3;
        }

        .article-content h2 {
            font-size: 2rem;
        }

        .article-content h3 {
            font-size: 1.6rem;
        }

        .article-content p {
            margin-bottom: 20px;
        }

        .article-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 30px 0;
        }

        .article-content ul,
        .article-content ol {
            margin-bottom: 20px;
            padding-left: 30px;
        }

        .article-content li {
            margin-bottom: 10px;
        }

        .article-content blockquote {
            border-left: 4px solid var(--base-color, #0d6efd);
            padding-left: 20px;
            margin: 30px 0;
            font-style: italic;
            color: #555;
            font-size: 1.15rem;
        }

        .article-content pre {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            border-left: 4px solid var(--base-color, #0d6efd);
        }

        .article-content code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .article-content pre code {
            background: transparent;
            padding: 0;
        }

        .article-content a {
            color: var(--base-color, #0d6efd);
            text-decoration: underline;
        }

        .article-content a:hover {
            text-decoration: none;
        }

        .comments-section {
            margin-top: 60px;
            padding-top: 40px;
            border-top: 2px solid #e0e0e0;
        }

        .comments-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 30px;
            color: #1a1a1a;
        }

        .back-to-blog {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--base-color, #0d6efd);
            text-decoration: none;
            font-weight: 600;
            margin-bottom: 30px;
            transition: gap 0.3s ease;
        }

        .back-to-blog:hover {
            gap: 12px;
        }

        .loading-skeleton {
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .article-reactions {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .reaction-like-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            border-radius: 25px;
            background: white;
            color: #666;
            text-decoration: none;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            border: 2px solid #e0e0e0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .reaction-like-btn:hover {
            background: #fff0f0;
            border-color: #ff6b6b;
            color: #ff6b6b;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(255, 107, 107, 0.2);
        }

        .reaction-like-btn i {
            font-size: 1.3rem;
        }

        .article-share {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .share-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            color: #666;
            text-decoration: none;
            transition: all 0.3s ease;
            border: 1px solid #e0e0e0;
        }

        .share-btn:hover {
            background: var(--base-color, #0d6efd);
            color: white;
            border-color: var(--base-color, #0d6efd);
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .article-title {
                font-size: 1.8rem;
            }

            .article-subtitle {
                font-size: 1rem;
            }

            .article-content {
                font-size: 1rem;
            }

            .article-content h2 {
                font-size: 1.5rem;
            }

            .article-content h3 {
                font-size: 1.3rem;
            }

            .article-reactions {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>

<body data-mobile-nav-style="classic" class="custom-cursor">
    <header class="header-with-topbar">
        <div class="header-top-bar top-bar-dark bg-base-color">
            <div class="container-fluid">
                <div class="row align-items-center m-0 h-45px xs-h-auto scrolling-text xs-pt-5px xs-pb-5px">
                    <div class="col-lg-6 col-md-7 text-center text-md-start xs-px-0">
                        <div class="fs-15 text-white fw-500">
                            <span>Nos experts vous accompagnent!
                                <a href="booking.html"
                                    class="text-white text-decoration-line-bottom fw-600 alt-font">Nous contacter</a>
                            </span>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-5 text-end d-none d-md-flex">
                        <div class="widget fs-15 fw-500 text-white d-none d-lg-inline-block">
                            <span><i class="feather icon-feather-map-pin"></i>Paris, France</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <nav class="navbar navbar-expand-lg header-light bg-white responsive-sticky">
            <div class="container-fluid">
                <div class="col-auto col-lg-2 me-lg-0 me-auto">
                    <a class="navbar-brand" href="/">
                        <img src="images/logo-rpam.png" alt="Logo RPAM" class="default-logo">
                    </a>
                </div>

                <button class="navbar-toggler d-lg-none ms-auto" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#mobileNav" aria-controls="mobileNav" aria-label="Ouvrir le menu">
                    <span class="navbar-toggler-line"></span>
                    <span class="navbar-toggler-line"></span>
                    <span class="navbar-toggler-line"></span>
                </button>

                <div class="navbar-collapse d-none d-lg-flex ms-4" id="navbarNavDesktop">
                    <ul class="navbar-nav fw-600">
                        <li class="nav-item">
                            <a href="/" class="nav-link">Accueil</a>
                        </li>
                        <li class="nav-item">
                            <a href="/about" class="nav-link">Qui sommes nous</a>
                        </li>
                        <li class="nav-item dropdown dropdown-with-icon-style02">
                            <a href="#" class="nav-link" id="navbarDropdownMenuLink" role="button"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                Nos Services
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                <li class="service-item">
                                    <a href="/guidance" class="tooltip">
                                        <img src="images/demo-accounting-company-icon-04.svg"
                                            alt="Orientation professionnelle">
                                        Orientation Professionnelle (Guidance)
                                    </a>
                                </li>
                                <li class="service-item">
                                    <a href="/up-training" class="tooltip">
                                        <img src="images/demo-accounting-company-icon-05.svg"
                                            alt="Développement de compétences">
                                        Développement de Compétences (Up Training)
                                    </a>
                                </li>
                                <li class="service-item">
                                    <a href="/job-getting" class="tooltip">
                                        <img src="images/demo-accounting-company-icon01.svg" alt="Coaching emploi">
                                        Coaching à la recherche d'emploi (Job Getting)
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a href="/blogs" class="nav-link active">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a href="/news" class="nav-link">Actualités</a>
                        </li>
                    </ul>
                </div>

                <a href="/booking"
                    class="btn btn-base-color btn-box-shadow text-transform-none btn-rounded btn-hover-animation-switch d-none d-lg-inline-flex ms-3">
                    Réserver un rendez-vous
                </a>
            </div>
        </nav>

        <!-- Offcanvas mobile -->
        <div class="offcanvas offcanvas-end offcanvas-mobile-nav" tabindex="-1" id="mobileNav">
            <div class="offcanvas-header">
                <a class="navbar-brand" href="/">
                    <img src="images/logo-rpam.png" alt="RPAM" class="mobile-logo">
                </a>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Fermer"></button>
            </div>
            <div class="offcanvas-body d-flex flex-column">
                <ul class="navbar-nav fw-600 nav-mobile">
                    <li class="nav-item"><a href="index.html" class="nav-link">Accueil</a></li>
                    <li class="nav-item"><a href="about.html" class="nav-link">Qui sommes nous</a></li>
                    <li class="nav-item">
                        <button class="btn w-100 text-start nav-link-like" data-bs-toggle="collapse"
                            data-bs-target="#mServices" aria-expanded="false">
                            Nos Services <span class="chevron"></span>
                        </button>
                        <div id="mServices" class="collapse">
                            <ul class="list-unstyled ps-3 mt-2 d-grid gap-2">
                                <li><a href="guidance.html" class="nav-sub-link">Orientation Professionnelle</a></li>
                                <li><a href="up-training.html" class="nav-sub-link">Développement de Compétences</a>
                                </li>
                                <li><a href="job-getting.html" class="nav-sub-link">Coaching à la recherche d'emploi</a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li class="nav-item"><a href="blogs.html" class="nav-link">Blog</a></li>
                    <li class="nav-item"><a href="news.html" class="nav-link">Actualités</a></li>
                </ul>
                <div class="mt-auto pt-3 border-top">
                    <a href="booking.html" class="btn btn-base-color btn-box-shadow btn-rounded w-100">
                        Réserver un rendez-vous
                    </a>
                </div>
            </div>
        </div>
    </header>

    <section class="pt-0 pb-0 bg-very-light-gray top-space-margin">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <article class="article-container">
                        <a href="blogs.html" class="back-to-blog">
                            <i class="feather icon-feather-arrow-left"></i>
                            Retour aux articles
                        </a>

                        <div id="article-loading" class="loading-skeleton">
                            <div class="bg-light" style="height: 400px; border-radius: 12px; margin-bottom: 30px;">
                            </div>
                            <div class="bg-light"
                                style="height: 60px; width: 80%; margin-bottom: 20px; border-radius: 8px;"></div>
                            <div class="bg-light"
                                style="height: 30px; width: 60%; margin-bottom: 30px; border-radius: 8px;"></div>
                        </div>

                        <div id="article-content" style="display: none;">
                            <div class="article-header">
                                <img id="cover-image" class="article-cover" src="" alt="">
                                <h1 id="title" class="article-title"></h1>
                                <p id="subtitle" class="article-subtitle"></p>

                                <div class="article-meta">
                                    <span>
                                        <i class="feather icon-feather-calendar"></i>
                                        <span id="published-date"></span>
                                    </span>
                                    <span id="read-time-container" style="display: none;">
                                        <i class="feather icon-feather-clock"></i>
                                        <span id="read-time"></span> min de lecture
                                    </span>
                                    <span>
                                        <i class="feather icon-feather-user"></i>
                                        <span id="author">RPAM</span>
                                    </span>
                                </div>

                                <div id="tags-container" class="article-tags"></div>
                            </div>

                            <div id="content" class="article-content"></div>

                            <div class="article-reactions">
                                <a href="#" id="like-btn" class="reaction-like-btn" target="_blank"
                                    title="J'aime cet article sur Hashnode">
                                    <i class="feather icon-feather-heart"></i>
                                    <span id="reaction-count">0</span> J'aime
                                </a>
                                <div class="article-share">

                                    <a href="#" id="share-twitter" class="share-btn" target="_blank"
                                        title="Partager sur Twitter">
                                        <i class="fa-brands fa-twitter"></i>
                                    </a>
                                    <a href="#" id="share-linkedin" class="share-btn" target="_blank"
                                        title="Partager sur LinkedIn">
                                        <i class="fa-brands fa-linkedin-in"></i>
                                    </a>
                                    <a href="#" id="share-facebook" class="share-btn" target="_blank"
                                        title="Partager sur Facebook">
                                        <i class="fa-brands fa-facebook-f"></i>
                                    </a>
                                </div>
                            </div>

                            <div class="comments-section">
                                <h2 class="comments-title">Commentaires</h2>
                                <div id="giscus-comments"></div>
                            </div>
                        </div>

                        <div id="article-error" style="display: none;">
                            <div class="alert alert-warning text-center p-5">
                                <h4 class="text-base-color mb-3">Article introuvable</h4>
                                <p class="mb-4">Désolé, nous n'avons pas pu charger cet article.</p>
                                <a href="blogs.html" class="btn btn-base-color btn-rounded btn-medium">
                                    Retour aux articles
                                </a>
                            </div>
                        </div>
                    </article>
                </div>

                <!-- Sidebar -->
                <aside class="col-lg-4">
                    <div class="sidebar-sticky" style="position: sticky; top: 100px;">
                        <!-- Articles recommandés -->
                        <div class="sidebar-widget mb-4">
                            <h3 class="sidebar-title">Articles recommandés</h3>
                            <div id="related-articles" class="related-articles-container">
                                <div class="text-center py-3">
                                    <div class="spinner-border spinner-border-sm text-base-color" role="status">
                                        <span class="visually-hidden">Chargement...</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Hashtags populaires -->
                        <div class="sidebar-widget">
                            <h3 class="sidebar-title">Hashtags populaires</h3>
                            <div id="popular-tags" class="tags-cloud">
                                <div class="text-center py-3">
                                    <div class="spinner-border spinner-border-sm text-base-color" role="status">
                                        <span class="visually-hidden">Chargement...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <footer class="footer-dark bg-dark-gray pt-0 pb-2 lg-pb-35px">
        <div
            class="footer-top pt-50px pb-50px sm-pt-35px sm-pb-35px border-bottom border-1 border-color-transparent-white-light">
            <div class="container">
                <div class="row align-items-center justify-content-center">
                    <div class="col-xl-6 text-center text-xl-start lg-mb-30px sm-mb-20px">
                        <h6 class="text-white mb-5px fw-500 ls-minus-1px">Boostez votre carrière profesionnelle.</h6>
                    </div>
                    <div class="col-xl-6 text-center text-xl-end">
                        <a href="booking.html"
                            class="btn text-white btn-extra-large bg-base-color left-icon btn-box-shadow btn-rounded text-transform-none d-inline-block align-middle me-15px xs-m-10px">
                            <i class="feather text-white icon-feather-mail"></i>Consultation gratuite
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row justify-content-center fs-17 fw-300 mt-5 mb-4">
                <div class="col-6 col-lg-3 order-sm-1">
                    <a href="/" class="footer-logo mb-15px d-inline-block">
                        <img src="images/w-logo-rpam.png" alt="RPAM">
                    </a>
                    <div class="elements-social social-icon-style-02 mt-20px">
                        <ul class="small-icon light">
                            <li><a class="facebook" href="https://www.facebook.com/" target="_blank"><i
                                        class="fa-brands fa-facebook-f"></i></a></li>
                            <li><a class="twitter" href="https://www.twitter.com" target="_blank"><i
                                        class="fa-brands fa-twitter"></i></a></li>
                            <li><a class="instagram" href="https://www.instagram.com" target="_blank"><i
                                        class="fa-brands fa-instagram"></i></a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-6 col-lg-2 col-sm-4 order-sm-3 order-lg-2">
                    <span class="fs-18 fw-400 d-block text-white mb-5px">À propos</span>
                    <ul>
                        <li><a href="about.html">Qui sommes-nous</a></li>
                        <li><a href="blogs.html">Blog</a></li>
                        <li><a href="news.html">Actualités</a></li>
                    </ul>
                </div>
                <div class="col-6 col-lg-2 col-sm-4 order-sm-4 order-lg-3">
                    <span class="fs-18 fw-400 d-block text-white mb-5px">Services</span>
                    <ul>
                        <li><a href="guidance.html">Orientation Professionnelle</a></li>
                        <li><a href="up-training.html">Développement de Compétences</a></li>
                        <li><a href="job-getting.html">Coaching emploi</a></li>
                    </ul>
                </div>
                <div class="col-6 col-lg-2 col-sm-4 order-sm-5 order-lg-4">
                    <span class="fs-18 fw-400 d-block text-white mb-5px">Contact</span>
                    <a href="mailto:contact@rpam.fr" class="text-white d-block mb-15px">contact@rpam.fr</a>
                </div>
            </div>
            <div class="row align-items-center fs-16 fw-300">
                <div class="col-md-4 text-center text-md-start">
                    <p>&copy; Copyright 2025 <a href="/" class="text-decoration-line-bottom text-white">RPAM</a></p>
                </div>
            </div>
        </div>
    </footer>

    <script src="js/jquery.js"></script>
    <script src="js/vendors.min.js"></script>
    <script src="js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Article Loading Script -->
    <script>
        // Fonction de sécurité pour échapper le HTML et prévenir les attaques XSS
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Fonction pour valider les URLs d'images
        function isValidImageUrl(url) {
            if (!url) return false;
            try {
                const urlObj = new URL(url);
                // Autoriser seulement HTTPS et domaines de confiance
                if (urlObj.protocol !== 'https:') return false;
                const allowedDomains = ['cdn.hashnode.com', 'hashnode.com', window.location.hostname];
                return allowedDomains.some(domain => urlObj.hostname.endsWith(domain));
            } catch {
                return false;
            }
        }

        const HASHNODE_CONFIG = {
            host: 'rpam.hashnode.dev',
            publicationId: '' // Sera rempli automatiquement
        };

        async function loadArticle() {
            const urlParams = new URLSearchParams(window.location.search);
            const slug = urlParams.get('slug');

            // Valider le slug (seulement alphanumérique, tirets et underscores)
            if (!slug || !/^[a-zA-Z0-9-_]+$/.test(slug) || slug.length > 200) {
                showError();
                return;
            }

            try {
                // Échapper le slug pour prévenir l'injection GraphQL
                const escapedSlug = slug.replace(/"/g, '\\"').replace(/\\/g, '\\\\');

                const query = `
                    query Post {
                        publication(host: "${HASHNODE_CONFIG.host}") {
                            id
                            post(slug: "${escapedSlug}") {
                                id
                                title
                                subtitle
                                brief
                                slug
                                content {
                                    html
                                }
                                coverImage {
                                    url
                                }
                                publishedAt
                                url
                                readTimeInMinutes
                                reactionCount
                                responseCount
                                author {
                                    name
                                }
                                tags {
                                    name
                                    slug
                                }
                                comments(first: 50) {
                                    totalDocuments
                                    edges {
                                        node {
                                            id
                                            content {
                                                text
                                            }
                                            author {
                                                name
                                                profilePicture
                                            }
                                            dateAdded
                                        }
                                    }
                                }
                            }
                        }
                    }
                `;

                const response = await fetch('https://gql.hashnode.com', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ query })
                });

                const data = await response.json();
                const publication = data.data?.publication;
                const post = publication?.post;

                if (!post) {
                    showError();
                    return;
                }

                // Stocker l'ID de la publication pour les commentaires
                HASHNODE_CONFIG.publicationId = publication.id;

                displayArticle(post);
                loadComments(post);
                loadRelatedArticles(post.slug);
                loadPopularTags();

            } catch (error) {
                console.error('Erreur lors du chargement de l\'article:', error);
                showError();
            }
        }

        function displayArticle(post) {
            // Mettre à jour les meta tags
            document.getElementById('article-title').textContent = post.title + ' - Blog RPAM';
            document.getElementById('article-description').content = post.brief;
            document.getElementById('og-title').content = post.title;
            document.getElementById('og-description').content = post.brief;
            if (post.coverImage?.url) {
                document.getElementById('og-image').content = post.coverImage.url;
            }

            // Afficher l'image de couverture - Validée pour sécurité
            if (post.coverImage?.url && isValidImageUrl(post.coverImage.url)) {
                document.getElementById('cover-image').src = post.coverImage.url;
                document.getElementById('cover-image').alt = escapeHtml(post.title);
            } else {
                document.getElementById('cover-image').style.display = 'none';
            }

            // Titre et sous-titre
            document.getElementById('title').textContent = post.title;
            if (post.subtitle) {
                document.getElementById('subtitle').textContent = post.subtitle;
            } else {
                document.getElementById('subtitle').style.display = 'none';
            }

            // Date de publication
            const date = new Date(post.publishedAt).toLocaleDateString('fr-FR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('published-date').textContent = date;

            // Temps de lecture
            if (post.readTimeInMinutes) {
                document.getElementById('read-time').textContent = post.readTimeInMinutes;
                document.getElementById('read-time-container').style.display = 'flex';
            }

            // Auteur
            if (post.author?.name) {
                document.getElementById('author').textContent = post.author.name;
            }

            // Tags - Échappés pour sécurité
            if (post.tags && post.tags.length > 0) {
                const tagsHTML = post.tags.map(tag =>
                    `<span class="article-tag">${escapeHtml(tag.name)}</span>`
                ).join('');
                document.getElementById('tags-container').innerHTML = tagsHTML;
            }

            // Contenu de l'article - Sanitisé avec DOMPurify pour prévenir les attaques XSS
            const sanitizedContent = DOMPurify.sanitize(post.content.html, {
                ALLOWED_TAGS: ['p', 'br', 'strong', 'em', 'u', 'i', 'b', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6',
                    'ul', 'ol', 'li', 'blockquote', 'pre', 'code', 'a', 'img', 'table', 'thead',
                    'tbody', 'tr', 'th', 'td', 'div', 'span', 'hr'],
                ALLOWED_ATTR: ['href', 'src', 'alt', 'title', 'class', 'id', 'target', 'rel'],
                ALLOW_DATA_ATTR: false,
                ALLOWED_URI_REGEXP: /^(?:(?:https?|mailto):)/i
            });
            document.getElementById('content').innerHTML = sanitizedContent;

            // Bouton J'aime et compteur de réactions
            const likeBtn = document.getElementById('like-btn');
            const reactionCount = document.getElementById('reaction-count');

            // Charger les réactions locales
            const localLikes = getLocalLikes(post.slug);
            const totalReactions = (post.reactionCount || 0) + localLikes;
            reactionCount.textContent = totalReactions;

            // Vérifier si l'utilisateur a déjà liké
            if (hasUserLiked(post.slug)) {
                likeBtn.classList.add('liked');
                likeBtn.style.background = '#fff0f0';
                likeBtn.style.borderColor = '#ff6b6b';
                likeBtn.style.color = '#ff6b6b';
            }

            // Gérer le clic sur le bouton J'aime
            likeBtn.href = '#';
            likeBtn.onclick = function (e) {
                e.preventDefault();
                toggleLike(post.slug, likeBtn, reactionCount, post.reactionCount || 0);
                return false;
            };

            // Boutons de partage
            const articleUrl = encodeURIComponent(window.location.href);
            const articleTitle = encodeURIComponent(post.title);

            document.getElementById('share-twitter').href =
                `https://twitter.com/intent/tweet?text=${articleTitle}&url=${articleUrl}`;
            document.getElementById('share-linkedin').href =
                `https://www.linkedin.com/sharing/share-offsite/?url=${articleUrl}`;
            document.getElementById('share-facebook').href =
                `https://www.facebook.com/sharer/sharer.php?u=${articleUrl}`;

            // Masquer le loader et afficher le contenu
            document.getElementById('article-loading').style.display = 'none';
            document.getElementById('article-content').style.display = 'block';
        }

        function loadComments(post) {
            const commentsContainer = document.getElementById('giscus-comments');

            // Afficher les commentaires existants
            if (post.comments && post.comments.edges.length > 0) {
                const commentsHTML = post.comments.edges.map(({ node: comment }) => {
                    const date = new Date(comment.dateAdded).toLocaleDateString('fr-FR', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });

                    return `
                        <div class="comment-item" style="border-bottom: 1px solid #e0e0e0; padding: 20px 0;">
                            <div style="display: flex; gap: 15px; margin-bottom: 10px;">
                                <img src="${escapeHtml(comment.author.profilePicture || 'https://via.placeholder.com/40')}"
                                     alt="${escapeHtml(comment.author.name)}"
                                     style="width: 40px; height: 40px; border-radius: 50%;"
                                     onerror="this.src='https://via.placeholder.com/40'">
                                <div>
                                    <strong style="display: block; color: #1a1a1a;">${escapeHtml(comment.author.name)}</strong>
                                    <small style="color: #666;">${escapeHtml(date)}</small>
                                </div>
                            </div>
                            <p style="margin-left: 55px; color: #333; line-height: 1.6;">${escapeHtml(comment.content.text)}</p>
                        </div>
                    `;
                }).join('');

                commentsContainer.innerHTML = `
                    <div style="margin-bottom: 30px;">
                        <h3 style="font-size: 1.2rem; font-weight: 600; margin-bottom: 20px;">
                            ${post.comments.totalDocuments} commentaire${post.comments.totalDocuments > 1 ? 's' : ''}
                        </h3>
                        ${commentsHTML}
                    </div>
                `;
            }

            // Charger et afficher les commentaires locaux
            loadLocalComments(post.slug, commentsContainer);

            // Ajouter le formulaire de commentaire local
            const commentFormHTML = `
                <div class="comment-form" style="background: #f8f9fa; padding: 30px; border-radius: 8px; margin-top: 30px;">
                    <h3 style="font-size: 1.2rem; font-weight: 600; margin-bottom: 20px;">Laisser un commentaire</h3>
                    <form id="local-comment-form" onsubmit="return handleCommentSubmit(event, '${post.slug}')">
                        <div class="mb-3">
                            <label for="comment-name" class="form-label fw-600">Nom *</label>
                            <input type="text" class="form-control" id="comment-name" required placeholder="Votre nom">
                        </div>
                        <div class="mb-3">
                            <label for="comment-email" class="form-label fw-600">Email *</label>
                            <input type="email" class="form-control" id="comment-email" required placeholder="votre@email.com">
                            <small class="text-muted">Votre email ne sera pas publié</small>
                        </div>
                        <div class="mb-3">
                            <label for="comment-text" class="form-label fw-600">Commentaire *</label>
                            <textarea class="form-control" id="comment-text" rows="4" required placeholder="Partagez votre avis..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-base-color btn-rounded">
                            <i class="feather icon-feather-send me-2"></i>
                            Publier le commentaire
                        </button>
                    </form>
                    <div class="mt-3">
                        <small class="text-muted">
                            <i class="feather icon-feather-info"></i>
                            Les commentaires sont stockés localement. Vous pouvez aussi <a href="${post.url}#comments" target="_blank">commenter sur Hashnode</a>.
                        </small>
                    </div>
                </div>
            `;

            commentsContainer.innerHTML += commentFormHTML;
        }

        function showError() {
            document.getElementById('article-loading').style.display = 'none';
            document.getElementById('article-error').style.display = 'block';
        }

        // Système de commentaires locaux
        function loadLocalComments(slug, container) {
            const localComments = getLocalComments(slug);

            if (localComments.length > 0) {
                const localCommentsHTML = localComments.map((comment, index) => {
                    const date = new Date(comment.date).toLocaleDateString('fr-FR', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });

                    // Générer un avatar avec les initiales
                    const initials = comment.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
                    const avatarColor = `hsl(${(index * 50) % 360}, 70%, 60%)`;

                    return `
                        <div class="comment-item" style="border-bottom: 1px solid #e0e0e0; padding: 20px 0;">
                            <div style="display: flex; gap: 15px; margin-bottom: 10px;">
                                <div style="width: 40px; height: 40px; border-radius: 50%; background: ${avatarColor}; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 0.9rem;">
                                    ${initials}
                                </div>
                                <div>
                                    <strong style="display: block; color: #1a1a1a;">${comment.name}</strong>
                                    <small style="color: #666;">${date}</small>
                                </div>
                            </div>
                            <p style="margin-left: 55px; color: #333; line-height: 1.6;">${escapeHtml(comment.text)}</p>
                        </div>
                    `;
                }).join('');

                const headerText = container.innerHTML.includes('commentaire') ? '' : `
                    <div style="margin-bottom: 30px;">
                        <h3 style="font-size: 1.2rem; font-weight: 600; margin-bottom: 20px;">
                            ${localComments.length} commentaire${localComments.length > 1 ? 's' : ''} local${localComments.length > 1 ? 'aux' : ''}
                        </h3>
                    </div>
                `;

                container.innerHTML += headerText + localCommentsHTML;
            }
        }

        function getLocalComments(slug) {
            const key = `comments_${slug}`;
            try {
                const comments = localStorage.getItem(key);
                if (!comments) return [];

                const parsed = JSON.parse(comments);

                // Valider que c'est un tableau
                if (!Array.isArray(parsed)) return [];

                // Valider et filtrer chaque commentaire
                return parsed.filter(comment => {
                    return comment
                        && typeof comment.name === 'string'
                        && typeof comment.text === 'string'
                        && typeof comment.date === 'string'
                        && comment.name.length <= 100
                        && comment.text.length <= 5000;
                });
            } catch (error) {
                console.error('Erreur lors de la lecture des commentaires locaux');
                return [];
            }
        }

        function saveLocalComment(slug, comment) {
            const comments = getLocalComments(slug);

            // Limiter à 50 commentaires par article
            if (comments.length >= 50) {
                alert('Limite de commentaires atteinte pour cet article (maximum 50)');
                return false;
            }

            comments.push(comment);
            const key = `comments_${slug}`;

            try {
                localStorage.setItem(key, JSON.stringify(comments));
                return true;
            } catch (error) {
                alert('Erreur lors de la sauvegarde du commentaire. Votre navigateur a peut-être atteint sa limite de stockage.');
                return false;
            }
        }

        function handleCommentSubmit(event, slug) {
            event.preventDefault();

            const name = document.getElementById('comment-name').value.trim();
            const email = document.getElementById('comment-email').value.trim();
            const text = document.getElementById('comment-text').value.trim();

            // Validation du nom
            if (name.length < 2 || name.length > 100) {
                alert('Le nom doit contenir entre 2 et 100 caractères');
                return false;
            }

            // Validation de l'email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Adresse email invalide');
                return false;
            }

            // Validation du texte
            if (text.length < 10 || text.length > 5000) {
                alert('Le commentaire doit contenir entre 10 et 5000 caractères');
                return false;
            }

            // Supprimer les balises HTML du texte
            const sanitizedText = text.replace(/<[^>]*>/g, '');

            const comment = {
                name: name,
                email: email,
                text: sanitizedText,
                date: new Date().toISOString()
            };

            if (!saveLocalComment(slug, comment)) {
                return false;
            }

            // Réinitialiser le formulaire
            document.getElementById('local-comment-form').reset();

            // Recharger la page pour afficher le nouveau commentaire
            location.reload();

            return false;
        }

        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }

        // Système de réactions locales (likes)
        function getLocalLikes(slug) {
            const key = `likes_${slug}`;
            return parseInt(localStorage.getItem(key) || '0');
        }

        function hasUserLiked(slug) {
            const key = `user_liked_${slug}`;
            return localStorage.getItem(key) === 'true';
        }

        function toggleLike(slug, button, countElement, hashnodeCount) {
            const key = `user_liked_${slug}`;
            const likesKey = `likes_${slug}`;
            const hasLiked = hasUserLiked(slug);

            if (hasLiked) {
                // Retirer le like
                localStorage.setItem(key, 'false');
                const currentLikes = getLocalLikes(slug);
                localStorage.setItem(likesKey, Math.max(0, currentLikes - 1).toString());

                button.classList.remove('liked');
                button.style.background = 'white';
                button.style.borderColor = '#e0e0e0';
                button.style.color = '#666';
            } else {
                // Ajouter le like
                localStorage.setItem(key, 'true');
                const currentLikes = getLocalLikes(slug);
                localStorage.setItem(likesKey, (currentLikes + 1).toString());

                button.classList.add('liked');
                button.style.background = '#fff0f0';
                button.style.borderColor = '#ff6b6b';
                button.style.color = '#ff6b6b';

                // Animation du coeur
                button.style.transform = 'scale(1.2)';
                setTimeout(() => {
                    button.style.transform = 'scale(1)';
                }, 200);
            }

            // Mettre à jour le compteur
            const localLikes = getLocalLikes(slug);
            const total = hashnodeCount + localLikes;
            countElement.textContent = total;
        }

        // Charger les articles recommandés
        async function loadRelatedArticles(currentSlug) {
            const container = document.getElementById('related-articles');

            try {
                const query = `
                    query Publication {
                        publication(host: "${HASHNODE_CONFIG.host}") {
                            posts(first: 6) {
                                edges {
                                    node {
                                        id
                                        title
                                        slug
                                        coverImage {
                                            url
                                        }
                                        publishedAt
                                        readTimeInMinutes
                                    }
                                }
                            }
                        }
                    }
                `;

                const response = await fetch('https://gql.hashnode.com', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ query })
                });

                const data = await response.json();
                const posts = data.data?.publication?.posts?.edges || [];

                // Filtrer l'article actuel et limiter à 4 articles
                const relatedPosts = posts
                    .filter(({ node }) => node.slug !== currentSlug)
                    .slice(0, 4);

                if (relatedPosts.length > 0) {
                    const articlesHTML = relatedPosts.map(({ node: post }) => {
                        const date = new Date(post.publishedAt).toLocaleDateString('fr-FR', {
                            day: 'numeric',
                            month: 'short',
                            year: 'numeric'
                        });

                        const coverImage = post.coverImage?.url || 'images/default-blog-cover.jpg';

                        const sanitizedCoverImage = (coverImage && isValidImageUrl(coverImage)) ? coverImage : 'images/default-blog-cover.jpg';

                        return `
                            <div class="related-article-item">
                                <img src="${escapeHtml(sanitizedCoverImage)}" alt="${escapeHtml(post.title)}" class="related-article-thumb" onerror="this.src='images/default-blog-cover.jpg'">
                                <div class="related-article-content">
                                    <h4>
                                        <a href="blog-post.html?slug=${encodeURIComponent(post.slug)}">${escapeHtml(post.title)}</a>
                                    </h4>
                                    <div class="related-article-meta">
                                        <i class="feather icon-feather-calendar" style="font-size: 0.75rem;"></i> ${escapeHtml(date)}
                                        ${post.readTimeInMinutes ? `
                                            <span class="ms-2">
                                                <i class="feather icon-feather-clock" style="font-size: 0.75rem;"></i> ${escapeHtml(post.readTimeInMinutes.toString())} min
                                            </span>
                                        ` : ''}
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');

                    container.innerHTML = articlesHTML;
                } else {
                    container.innerHTML = '<p class="text-muted text-center">Aucun article disponible</p>';
                }

            } catch (error) {
                console.error('Erreur lors du chargement des articles recommandés:', error);
                container.innerHTML = '<p class="text-muted text-center">Erreur de chargement</p>';
            }
        }

        // Charger les hashtags populaires
        async function loadPopularTags() {
            const container = document.getElementById('popular-tags');

            try {
                const query = `
                    query Publication {
                        publication(host: "${HASHNODE_CONFIG.host}") {
                            posts(first: 20) {
                                edges {
                                    node {
                                        tags {
                                            name
                                            slug
                                        }
                                    }
                                }
                            }
                        }
                    }
                `;

                const response = await fetch('https://gql.hashnode.com', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ query })
                });

                const data = await response.json();
                const posts = data.data?.publication?.posts?.edges || [];

                // Compter les occurrences de chaque tag
                const tagCounts = {};
                posts.forEach(({ node: post }) => {
                    if (post.tags) {
                        post.tags.forEach(tag => {
                            if (tagCounts[tag.name]) {
                                tagCounts[tag.name]++;
                            } else {
                                tagCounts[tag.name] = 1;
                            }
                        });
                    }
                });

                // Trier par popularité et prendre les 10 premiers
                const sortedTags = Object.entries(tagCounts)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 10);

                if (sortedTags.length > 0) {
                    const tagsHTML = sortedTags.map(([tagName, count]) => {
                        return `
                            <a href="blogs.html#tag-${tagName.toLowerCase()}" class="tag-item" title="${count} article${count > 1 ? 's' : ''}">
                                #${tagName}
                            </a>
                        `;
                    }).join('');

                    container.innerHTML = tagsHTML;
                } else {
                    container.innerHTML = '<p class="text-muted text-center">Aucun hashtag disponible</p>';
                }

            } catch (error) {
                console.error('Erreur lors du chargement des hashtags:', error);
                container.innerHTML = '<p class="text-muted text-center">Erreur de chargement</p>';
            }
        }

        // Charger l'article au chargement de la page
        document.addEventListener('DOMContentLoaded', loadArticle);
    </script>
</body>

</html>